<!DOCTYPE html>
<html lang="zh">

<head>
    <!-- 2021-07-09 Fri 11:00 -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>SM2 算法税务数字证书应用接口规范</title>
    <meta name="generator" content="Org mode">
    <meta name="author" content="Jack Liu">
    <link rel="shortcut icon" href="themes/assets/virgo.png" type="image/x-icon" />
    <link rel="stylesheet" href="themes/style.css" type="text/css" />
    <script type="module" src="themes/main.js" defer></script>
</head>

<body>
    <div id="content">
        <h1 class="title">SM2 算法税务数字证书应用接口规范</h1>
        <div id="table-of-contents">
            <h2>Table of Contents</h2>
            <div id="text-table-of-contents">
                <ul>
                    <li><a href="#orgf4c2613">简介</a>
                        <ul>
                            <li><a href="#orgad319d5">术语和定义</a></li>
                            <li><a href="#org597d88b">缩略语</a></li>
                            <li><a href="#orge2ae1de">证书应用接口</a></li>
                        </ul>
                    </li>
                    <li><a href="#org40827a0">客户端接口</a></li>
                    <li><a href="#org4df04a1"><span class="todo TODO">TODO</span> 服务器端接口</a></li>
                    <li><a href="#orga9466d8">*密码相关拓展</a></li>
                </ul>
            </div>
        </div>

        <div id="outline-container-orgf4c2613" class="outline-2">
            <h2 id="orgf4c2613">简介</h2>
            <div class="outline-text-2" id="text-orgf4c2613">
                <p>
                    本规范规定了 SM2 算法税务数字证书应用接口的类型、功能、数据格式、密码算法等内容。
                </p>
            </div>

            <div id="outline-container-orgad319d5" class="outline-3">
                <h3 id="orgad319d5">术语和定义</h3>
                <div class="outline-text-3" id="text-orgad319d5">
                    <p>
                        <span class="underline">SM2 算法</span> 是由国家密码管理局批准的一种椭圆曲线公钥密码算法。
                    </p>

                    <p>
                        <span class="underline">数字证书</span>
                        是由国家认可的，具有权威性、可信性和公正性的认证机构进行数字签名，包含公开密钥拥有者信息、公开密钥、签发者信息、有效期以及一些扩展信息的数字化文件。
                    </p>

                    <p>
                        <span class="underline">税务数字证书</span> 是指由税务数字证书系统所签发的数字证书。
                    </p>

                    <p>
                        <span class="underline">SM2 算法税务数字证书</span> 是指由 SM2 算法税务数字证书系统所签发的数字证书，其对应的公钥算法为 SM2 。
                    </p>

                    <p>
                        <span class="underline">密钥容器</span> 是指密码设备中用于保存密钥和数字证书所划分的存储空间。
                    </p>

                    <p>
                        <span class="underline">国标接口</span> 是指遵循密码管理局制定的密码设备相关规范的应用接口。
                    </p>

                    <p>
                        <span class="underline">签名验签服务器</span> 为应用系统 提供基于 PKI
                        体系和数字证书的数字签名、验证签名等运算功能的服务器，可以保证关键业务信息的真实性、完整性和不可否认性。
                    </p>
                </div>
            </div>

            <div id="outline-container-org597d88b" class="outline-3">
                <h3 id="org597d88b">缩略语</h3>
                <div class="outline-text-3" id="text-org597d88b">
                    <p>
                        *仅适用于本文件
                    </p>

                    <table>

                        <colgroup>
                            <col class="org-left">

                            <col class="org-left">
                        </colgroup>
                        <tbody>
                            <tr>
                                <td class="org-left">LDAP</td>
                                <td class="org-left">轻量级目录访问协议</td>
                            </tr>

                            <tr>
                                <td class="org-left">OCSP</td>
                                <td class="org-left">在线证书状态协议</td>
                            </tr>

                            <tr>
                                <td class="org-left">OID</td>
                                <td class="org-left">对象标识符</td>
                            </tr>

                            <tr>
                                <td class="org-left">PKI</td>
                                <td class="org-left">公钥密码基础设施</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="outline-container-orge2ae1de" class="outline-3">
                <h3 id="orge2ae1de">证书应用接口</h3>
                <div class="outline-text-3" id="text-orge2ae1de">
                    <p>
                        证书应用接口提供证书读取、身份认证、数字签名、签名验证、数字信封加解密等功能。
                    </p>

                    <p>
                        <span class="underline">1. 接口类型</span>
                    </p>

                    <p>
                        证书应用接口包括服务端接口和客户端接口。
                    </p>

                    <p>
                        <span class="underline">服务端接口</span> 是部署在应用系统服务端，通过 <b>签名验签服务器</b>
                        实现身份认证、数字签名、签名验证、数字信封加解密等安全功能的接口。
                    </p>

                    <p>
                        <span class="underline">客户端接口</span> 是部署在应用系统客户端，通过 <b>税务数字证书介质</b>
                        实现身份认证、数字签名、签名验证、数字信封加解密等安全功能的接口。
                    </p>

                    <p>
                        <span class="underline">2. 接口功能</span>
                    </p>

                    <p>
                        证书应用接口实现的功能包括：
                    </p>
                    <ol class="org-ol">
                        <li>读取证书；</li>
                        <li>解析证书内容；</li>
                        <li>身份认证；</li>
                        <li>数据摘要；</li>
                        <li>数字签名；</li>
                        <li>签名验证；</li>
                        <li>制作数字信封；</li>
                        <li>解数字信封。</li>
                    </ol>

                    <p>
                        <span class="underline">3. 接口密码设备</span>
                    </p>

                    <p>
                        证书应用接口支持的 <b>密码设备</b> 类型有：
                    </p>
                    <ul class="org-ul">
                        <li>服务端密码设备 - 签名验签服务器；</li>
                        <li>客户端密码设备 - 支持国标接口的税务数字证书介质，包括但不限于 USBKey、SIM 卡、PSAM 卡、金税盘、税控盘、税务 UKey 和税控服务器等多种形态的证书介质。</li>
                    </ul>

                    <p>
                        密码设备通过划分多个密钥容器存储多对公钥和证书，根据密钥容器名称获取对应容器的密钥和证书。
                    </p>
                </div>
            </div>
        </div>

        <div id="outline-container-org40827a0" class="outline-2">
            <h2 id="org40827a0">客户端接口</h2>
            <div class="outline-text-2" id="text-org40827a0">
                <p>
                    客户端接口采用 WEB 服务方式，可供浏览器和多种语言调用，用于客户端设备（如 USBKey、税控服务器和税务 UKey 等）读取信息、身份认证、签名验证等操作。
                </p>

                <table>
                    <caption class="t-above"><span class="table-number">Table 1:</span> 接口方法</caption>

                    <colgroup>
                        <col class="org-center">

                        <col class="org-left">

                        <col class="org-left">
                    </colgroup>
                    <thead>
                        <tr>
                            <th scope="col" class="org-center">序号</th>
                            <th scope="col" class="org-left">接口方法</th>
                            <th scope="col" class="org-left">功能</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="org-center">1</td>
                            <td class="org-left"><code>https://host:port/api/getVersion</code></td>
                            <td class="org-left">获取接口版本号</td>
                        </tr>

                        <tr>
                            <td class="org-center">2</td>
                            <td class="org-left"><code>https://host:port/api/devicecertreq</code></td>
                            <td class="org-left">生成设备证书申请</td>
                        </tr>

                        <tr>
                            <td class="org-center">3</td>
                            <td class="org-left"><code>https://host:port/api/importdevicecert</code></td>
                            <td class="org-left">导入设备证书</td>
                        </tr>

                        <tr>
                            <td class="org-center">4</td>
                            <td class="org-left"><code>https://host:port/api/certreq</code></td>
                            <td class="org-left">生成用户证书申请</td>
                        </tr>

                        <tr>
                            <td class="org-center">5</td>
                            <td class="org-left"><code>https://host:port/api/importcert</code></td>
                            <td class="org-left">导入用户证书</td>
                        </tr>

                        <tr>
                            <td class="org-center">6</td>
                            <td class="org-left"><code>https://host:port/api/clientHello</code></td>
                            <td class="org-left">生成客户端认证请求</td>
                        </tr>

                        <tr>
                            <td class="org-center">7</td>
                            <td class="org-left"><code>https://host:port/api/clientAuth</code></td>
                            <td class="org-left">生成客户端认证凭据</td>
                        </tr>

                        <tr>
                            <td class="org-center">8</td>
                            <td class="org-left"><code>https://host:port/api/checkCert</code></td>
                            <td class="org-left">检查容器</td>
                        </tr>

                        <tr>
                            <td class="org-center">9</td>
                            <td class="org-left"><code>https://host:port/api/readCert</code></td>
                            <td class="org-left">读证书</td>
                        </tr>

                        <tr>
                            <td class="org-center">10</td>
                            <td class="org-left"><code>https://host:port/api/readCertInfo</code></td>
                            <td class="org-left">解析证书信息</td>
                        </tr>

                        <tr>
                            <td class="org-center">11</td>
                            <td class="org-left"><code>https://host:port/api/destroy</code></td>
                            <td class="org-left">销毁用户证书</td>
                        </tr>

                        <tr>
                            <td class="org-center">12</td>
                            <td class="org-left"><code>https://host:port/api/sign</code></td>
                            <td class="org-left">SM2 签名</td>
                        </tr>

                        <tr>
                            <td class="org-center">13</td>
                            <td class="org-left"><code>https://host:port/api/verify</code></td>
                            <td class="org-left">验证 SM2 签名</td>
                        </tr>

                        <tr>
                            <td class="org-center">14</td>
                            <td class="org-left"><code>https://host:port/api/signData</code></td>
                            <td class="org-left">SM2 消息签名</td>
                        </tr>

                        <tr>
                            <td class="org-center">15</td>
                            <td class="org-left"><code>https://host:port/api/verifySign</code></td>
                            <td class="org-left">验证 SM2 消息签名</td>
                        </tr>

                        <tr>
                            <td class="org-center">16</td>
                            <td class="org-left"><code>https://host:port/api/digestData</code></td>
                            <td class="org-left">消息摘要</td>
                        </tr>

                        <tr>
                            <td class="org-center">17</td>
                            <td class="org-left"><code>https://host:port/api/envelop</code></td>
                            <td class="org-left">制作数字信封</td>
                        </tr>

                        <tr>
                            <td class="org-center">18</td>
                            <td class="org-left"><code>https://host:port/api/unEnvelope</code></td>
                            <td class="org-left">解密数字信封</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div id="outline-container-org4df04a1" class="outline-2">
            <h2 id="org4df04a1"><span class="todo TODO">TODO</span> 服务器端接口</h2>
            <div class="outline-text-2" id="text-org4df04a1">
                <p>
                    暂不用……
                </p>
            </div>
        </div>

        <div id="outline-container-orga9466d8" class="outline-2">
            <h2 id="orga9466d8">*密码相关拓展</h2>
            <div class="outline-text-2" id="text-orga9466d8">
                <img src="https://www.ruanyifeng.com/blogimg/asset/201307/bg2013070301.png" width="120" height=""
                    style="float: right; margin-left: 8px; " title="" />

                <ul class="org-ul">
                    <li><a href="https://www.ruanyifeng.com/blog/2006/12/notes_on_cryptography.html">密码学笔记</a></li>
                    <li><a href="https://www.ruanyifeng.com/blog/2013/06/rsa_algorithm_part_one.html">RSA 算法原理（一）</a>
                    </li>
                    <li><a href="https://www.ruanyifeng.com/blog/2013/07/rsa_algorithm_part_two.html">RSA 算法原理（二）</a>
                    </li>
                </ul>

                <div class="jk-essay">
                    Hmm... 数学，这个奇妙的东西，真的让人爱恨交加！
                </div>
            </div>
        </div>
    </div>
    <div id="postamble" class="status">
        <p class="date">Date: 2021-07-09 Fri 09:03</p>
        <p class="author">Author: Jack Liu</p>
        <p class="date">Created: 2021-07-09 Fri 11:00</p>
        <p class="validation"><a href="http://beian.miit.gov.cn/">豫ICP备19900901号</a></p>
    </div>
</body>

</html>